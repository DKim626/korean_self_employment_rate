---
title: "README"
author: "Dongwook Kim"
date: "`r Sys.Date()`"
output:
  pdf_document:
    latex_engine: xelatex
    toc: true
    number_sections: true
---
# KEAPS Self-employment Rate

This project analyzes **self-employment rates** using Korean Economically Active Population Survey (KEAPS) **from 1981 to 2024**. It calculates and visualizes trends by **year, industry(KSIC), age, and gender**.

## Overview

-   **Data source**: KEAPS (Korean Economically Active Population Survey)
    -   Available at [MDIS] (<https://mdis.kostat.go.kr/eng/index.do>)
-   **Scope**
    -   **Period**: 1981 - 2024 (monthly KEAPS microdata)
    -   **Unit of analysis**: Individuals of age 15+
    -   **Key variables**:
        -   Employment status, industry (KSIC), gender & age group
        -   Self-employment classification
            -   **Type 1 (OECD)**: Family workers + self-employed with and without employees
            -   **Type 2 (KOSIS)**: Self-employed with and without employees
            -   **Type 3 (Project)**: Self-employed without employees only
    -   **Aggregation level**:
        -   Yearly trends
        -   Industry-level trends
        -   Age & Gender group trends
-   **Outputs**
    -   **Monthly Outputs**
        -   `month_trends_age_group_2.rdata`, etc.: monthly trends
            -   `month_overall`: monthly self-employment rates
            -   `month_ind`: monthly rates by industry
            -   `month_as`: monthly rates by age & gender group
            -   `month_as_wg`: monthly rates within age & gender group
            -   `month_supp`: monthly labor participation & unemployment rates
    -   **Yearly Outputs**
        -   `year_trends_age_group_2.rdata`, etc.: yearly trends
            -   `year_overall`: yearly self-employment rates
            -   `year_ind`: yearly rates by industry
            -   `year_as`: yearly rates by age & gender group
            -   `year_as_wg`: yearly rates within age & gender group
            -   `year_supp`: yearly labor participation & unemployment rates

## Project Structure

```     
Project/
│
├── R/
│   ├── raw/                    # Raw .R scripts from KOSIS
│   ├── modules/
│   │      ├─preprocess/        # Preprocessing functions
│   │      ├─cleaning/          # Variable cleaning & standardization
│   │      ├─calc/              # Calculation of self-employment rates
│   │      └─visualization/     # Plotting functions
│   │
│   ├── main_pipeline.R
│   ├── 01_preprocess.R
│   ├── 02_data_clean.R
│   ├── 03_rate_calculation.R
│   └── 04_data_visualization.R # Will be uploaded soon
│
├── data/
│   ├── raw/                    # Raw KEAPS .csv files
│   ├── processed/              # Processed .rds files
│   ├── cleaned/                # Cleaned .rds files
│   └── output/                 # Final monthly/yearly .rdata files
│
├── image/
│
└── README.md                   # This documentation
```

## How to Run

1.  Place raw `.csv` files in `data/raw/`
2.  Place KOSIS `.R` scripts in `R/raw/`
3.  In RStudio (project opened with `.Rproj`), open `main_pipeline.R`
4.  Run all sections
5.  Outputs will be saved in `data/output/` as `.rdata` files
6.  Images will be saved in `image/`

## Analysis Pipeline

1.  **Process raw data**
    -   Raw `.csv` files are processed with KOSIS-provided scripts
2.  **Load raw data**
    -   `.rds` files from 1981–2024 stored in `data/processed/`
3.  **Standardize variables**
    -   Aligns consistent variable names across years
4.  **Recode variables**
    -   Translates Korean -\> English
    -   Groups ages hierarchically:
        -   5-year intervals
        -   60+, 70+, 80+ categories
    -   Classifies self-employment into 3 types (see above)
5.  **Calculate monthly rates**
    -   Self-employment rate (overall, by industry, by/within group)
    -   Supplementary: labor force participation & unemployment rate
6.  **Aggregate to yearly outputs**
    -   Averages monthly results by year

## Dependencies

-   **R** (\>= 4.4.1)
-   **Required Packages**:
    -   `dplyr`
    -   `stringr`
    -   `rlang`
    -   `purrr`
    -   `stringi`
    -   `data.table`
    -   `readr`
    -   `ggplot2`
-   **Optional**: `grafify` for color palettes
-   To install the packages, use in R:

```         
install.packages(c("dplyr", "stringr", "rlang", "purrr", "stringi", "data.table", "readr", "ggplot2"))
```

## Example Output

Below is an example plot showing yearly trends of self-employment rate (1981-2024). Each colored line shows different types of self-employment as defined above. The dashed line represents tax-data comparable estimates which excludes family workers from the employed population. A vertical red line indicates 1997 IMF Financial Crisis. ![Example Plot of Yearly Trends](image/year_trends_1981_2024.png)

## Known Issues

-   **KOSIS codes**: Use `"CP949"` to read `.R` scripts correctly
    -   *RStudio -\> File -\> Reopen with Encoding -\> "CP949"*
-   **1983 survey**: Economic activity data highly likely corrupted
    -   Participation rate is 1 in most months; results unreliable
-   **1984 survey**: `weight` variable miscoded
    -   Contains prefix "\xb"; fixed manually
-   **1986 survey**: `recode_factor()` in original KOSIS script was misaligned
    -   Fixed in `code/raw/fix_1986.R`
-   **KSIC Industry Codes** revised over times:
    -   5th KSIC: 1986 - 1992
    -   6th/7th KSIC: 1993 - 2000
    -   8th KSIC: 2000 - 2008
    -   9th KSIC: 2004 - 2017
    -   10th, 11th KSIC: 2013 - 2024
    -   Mapping handled in `ksic_mapping.R`